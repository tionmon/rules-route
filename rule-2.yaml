# port: 7890
# socks-port: 7891
# redir-port: 7892
# tproxy-port: 7893
mixed-port: 19098
allow-lan: true
bind-address: "*"
mode: rule
log-level: info
external-controller: 127.0.0.1:18848

geodata-mode: true 
geodata-loader: memconservative
geo-auto-update: true
geo-update-interval: 24
geox-url:
  geoip: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat"
  geosite: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat"
  mmdb: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/country.mmdb"
  asn: "https://github.com/xishang0128/geoip/releases/download/latest/GeoLite2-ASN.mmdb"
dns:
  enable: true
  prefer-h3: false # DOH ä¼˜å…ˆä½¿ç”¨ http/3
  use-hosts: true # æ˜¯å¦å›åº”é…ç½®ä¸­çš„ hostsï¼Œé»˜è®¤ true
  use-system-hosts: false # æ˜¯å¦æŸ¥è¯¢ç³»ç»Ÿ hostsï¼Œé»˜è®¤ true
  # listen: 0.0.0.0:53 # DNS æœåŠ¡ç›‘å¬ï¼Œä»…æ”¯æŒ udp
  ipv6: false
  default-nameserver: # é»˜è®¤ DNS, ç”¨äºè§£æ DNS æœåŠ¡å™¨ çš„åŸŸåï¼Œå¿…é¡»ä¸º IP, å¯ä¸ºåŠ å¯† DNS
    - 1.2.4.8
    - tls://223.5.5.5
  enhanced-mode: fake-ip # or reder-host
  fake-ip-range: 172.29.0.1/16 # Fake-IP è§£æåœ°å€æ± 
  fake-ip-filter: # Fake-IP è¿‡æ»¤ï¼Œåˆ—è¡¨ä¸­çš„åŸŸåè¿”å›çœŸå® IP
    - '+.local'
    - '+.lan'
    - '+.in-addr.arpa'
    - 'injections.adguard.org'
    - 'local.adguard.org'
  respect-rules: false
  # é…ç½®æŸ¥è¯¢åŸŸåä½¿ç”¨çš„ DNS æœåŠ¡å™¨
  nameserver-policy:
    "+.lan,+.in-addr.arpa": system
    # å¹¿å‘Šæ‹¦æˆªï¼Œæ•ˆæœæœ‰é™ï¼Œè¯·ä½¿ç”¨æµè§ˆå™¨æ‰©å±•ç­‰æ›´æœ‰æ•ˆçš„æ‰‹æ®µ
    # ç«™é•¿æ³¨æ„ï¼Œä¼šæ‹¦æˆª Google Analytics
    # "geosite:category-ads-all": rcode://success
    "rule-set:direct":
      - tls://223.5.5.5
      - tls://223.6.6.6
      - 'https://223.5.5.5/dns-query#h3=true'
      - 'https://223.6.6.6/dns-query#h3=true'
    "geosite:private,onedrive,microsoft@cn,apple@cn,steam@cn,google@cn,jetbrains@cn,category-games@cn,cn":
      - tls://223.5.5.5
      - tls://223.6.6.6
      - 'https://223.5.5.5/dns-query#h3=true'
      - 'https://223.6.6.6/dns-query#h3=true'
  proxy-server-nameserver:
    - 'https://223.5.5.5/dns-query#h3=true'
    - 'https://223.6.6.6/dns-query#h3=true'
  nameserver:
    # Google
    - 'tls://8.8.8.8#ğŸŒ å›½å¤–è®¿é—®'
    - 'tls://8.8.4.4#ğŸŒ å›½å¤–è®¿é—®'
    - 'https://8.8.8.8/dns-query#ğŸŒ å›½å¤–è®¿é—®&h3=true'
    - 'https://8.8.4.4/dns-query#ğŸŒ å›½å¤–è®¿é—®&h3=true'
    # Cloudflare
    - 'tls://1.1.1.1#ğŸŒ å›½å¤–è®¿é—®'
    - 'tls://1.0.0.1#ğŸŒ å›½å¤–è®¿é—®'
    - 'https://1.1.1.1/dns-query#ğŸŒ å›½å¤–è®¿é—®&h3=true'
    - 'https://1.0.0.1/dns-query#ğŸŒ å›½å¤–è®¿é—®&h3=true'
    # dns.sb
    - 'tls://185.222.222.222#ğŸŒ å›½å¤–è®¿é—®'
    - 'tls://45.11.45.11#ğŸŒ å›½å¤–è®¿é—®'
    - 'https://185.222.222.222/dns-query#ğŸŒ å›½å¤–è®¿é—®'
    - 'https://45.11.45.11/dns-query#ğŸŒ å›½å¤–è®¿é—®'

proxies:

proxy-groups:
  - { name: "ğŸ¯ å¤§é™†ç›´è¿", type: select, proxies: [DIRECT], url: "http://www.gstatic.com/generate_204", interval: 7200 }
  - { name: "ğŸ’¬ AI æœåŠ¡", type: select, proxies: [DIRECT], url: "http://www.gstatic.com/generate_204", interval: 7200 }
  - { name: "ğŸ® æ¸¸æˆå¹³å°", type: select, proxies: [DIRECT], url: "http://www.gstatic.com/generate_204", interval: 7200 }
  - { name: "â“‚ï¸ å¾®è½¯æœåŠ¡", type: select, proxies: [DIRECT], url: "http://www.gstatic.com/generate_204", interval: 7200 }
  - { name: "ğŸŒ å›½å¤–è®¿é—®", type: select, proxies: [DIRECT], url: "http://www.gstatic.com/generate_204", interval: 7200 }

rules:

  # ä¸ªäººè‡ªå®šä¹‰
  - RULE-SET,category-ai-chat-!cn,ğŸ’¬ AI æœåŠ¡
  # æ³¨æ„ï¼šGithubä¹Ÿåœ¨è¿™é‡Œå“¦ï¼
  - RULE-SET,microsoft,â“‚ï¸ å¾®è½¯æœåŠ¡
  - RULE-SET,steam,ğŸ® æ¸¸æˆå¹³å°
  - RULE-SET,epicgames,ğŸ® æ¸¸æˆå¹³å°
  - RULE-SET,ea,ğŸ® æ¸¸æˆå¹³å°
  - RULE-SET,ubisoft,ğŸ® æ¸¸æˆå¹³å°
  - RULE-SET,blizzard,ğŸ® æ¸¸æˆå¹³å°

  # è§„åˆ™é›†
  - RULE-SET,reject,REJECT
  - RULE-SET,proxy,ğŸŒ å›½å¤–è®¿é—®
  - RULE-SET,direct,ğŸ¯ å¤§é™†ç›´è¿

  # å¹¿å‘Šè¿‡æ»¤
  - GEOSITE,category-ads-all,REJECT

  # ç›´è¿ï¼Œ@cn ä¸ºè¯¥è§„åˆ™å†…çš„åŸŸååœ¨ä¸­å›½å¤§é™†æœ‰æ¥å…¥ç‚¹
  - GEOSITE,private,ğŸ¯ å¤§é™†ç›´è¿
  - GEOSITE,onedrive,ğŸ¯ å¤§é™†ç›´è¿
  - GEOSITE,microsoft@cn,ğŸ¯ å¤§é™†ç›´è¿
  - GEOSITE,apple@cn,ğŸ¯ å¤§é™†ç›´è¿
  - GEOSITE,steam@cn,ğŸ¯ å¤§é™†ç›´è¿
  - GEOSITE,google@cn,ğŸ¯ å¤§é™†ç›´è¿
  - GEOSITE,jetbrains@cn,ğŸ¯ å¤§é™†ç›´è¿
  - GEOSITE,category-games@cn,ğŸ¯ å¤§é™†ç›´è¿
  # æµåª’ä½“
  - GEOSITE,biliintl,ğŸŒ å›½å¤–è®¿é—®
  - GEOSITE,youtube,ğŸŒ å›½å¤–è®¿é—®
  - GEOSITE,netflix,ğŸŒ å›½å¤–è®¿é—®
  - GEOSITE,disney,ğŸŒ å›½å¤–è®¿é—®
  - GEOSITE,amazon,ğŸŒ å›½å¤–è®¿é—®
  - GEOSITE,disneyplus,ğŸŒ å›½å¤–è®¿é—®
  # å¼ºåˆ¶ä»£ç†
  - GEOSITE,google,ğŸŒ å›½å¤–è®¿é—®
  - GEOSITE,twitter,ğŸŒ å›½å¤–è®¿é—®
  - GEOSITE,pixiv,ğŸŒ å›½å¤–è®¿é—®
  - GEOSITE,category-scholar-!cn,ğŸŒ å›½å¤–è®¿é—®
  - GEOSITE,geolocation-!cn,ğŸŒ å›½å¤–è®¿é—®

  # å…œåº•å¼ºåˆ¶ç›´è¿
  - GEOSITE,cn,ğŸ¯ å¤§é™†ç›´è¿

  # GEOIP è§„åˆ™
  - GEOIP,private,ğŸ¯ å¤§é™†ç›´è¿
  - GEOIP,telegram,ğŸŒ å›½å¤–è®¿é—®
  - GEOIP,JP,ğŸŒ å›½å¤–è®¿é—®
  - GEOIP,CN,ğŸ¯ å¤§é™†ç›´è¿

  # LAN
  - IP-CIDR,127.0.0.0/8,DIRECT
  - IP-CIDR,172.16.0.0/12,DIRECT
  - IP-CIDR,192.168.0.0/16,DIRECT
  - IP-CIDR,10.0.0.0/8,DIRECT
  - IP-CIDR,17.0.0.0/8,DIRECT       # ç»„ç½‘åœ°å€
  - IP-CIDR,100.64.0.0/10,DIRECT    # NAT åœ°å€
  - IP-CIDR,224.0.0.0/4,DIRECT      # ç»„æ’­åœ°å€
  - IP-CIDR6,fe80::/10,DIRECT       # IPv6 æœ¬åœ°é“¾è·¯åœ°å€

  # æ¼ç½‘ä¹‹é±¼
  - MATCH,ğŸŒ å›½å¤–è®¿é—®

rule-providers:
  direct:
    behavior: classical
    type: inline
    payload:
      # CDN
      - 'DOMAIN,download-cdn.jetbrains.com'
      # Clash Dashboard & Converter
      - 'DOMAIN,clash.razord.top'
      - 'DOMAIN,yacd.haishan.me'
      - 'DOMAIN,nexconvert.com'
      # DDNS
      - 'DOMAIN-SUFFIX,ip.sb'
      # time
      - 'DOMAIN,time.android.com'
  proxy:
    behavior: classical
    type: inline
    payload:
      # ç›´è¿ä½“éªŒä¸ä½³ï¼Œå¼ºåˆ¶ä»£ç†
      - 'DOMAIN,dockerstatic.com'
      - 'DOMAIN,fonts.googleapis.com'
      - 'DOMAIN,fonts.gstatic.com'
      - 'DOMAIN,www.gstatic.com'
  reject:
    behavior: classical
    type: inline
    payload:
      # niconico å¹¿å‘Š
      - 'DOMAIN-SUFFIX,ads.nicovideo.jp'
      # mumu æ¨¡æ‹Ÿå™¨å¹¿å‘Š
      - 'DOMAIN-SUFFIX,mumu.nie.netease.com'
      # postman æ›´æ–°
      - 'DOMAIN-SUFFIX,dl.pstmn.io'
      - 'DOMAIN-SUFFIX,sync-v3.getpostman.com'
      - 'DOMAIN-SUFFIX,getpostman.com'

  # AI æœåŠ¡
  category-ai-chat-!cn:
    type: http
    format: yaml # å¯ä¸å¡«ï¼Œé»˜è®¤ä¸º yaml
    behavior: domain
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/category-ai-!cn.yaml
    path: ./ruleset/category-ai-!cn.yaml
    interval: 86400

  # å¾®è½¯æœåŠ¡
  microsoft:
    type: http
    behavior: domain
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/microsoft.yaml
    path: ./ruleset/microsoft.yaml
    interval: 86400

  # æ¸¸æˆå¹³å°
  steam:
    type: http
    behavior: domain
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/steam.yaml
    path: ./ruleset/steam.yaml
    interval: 86400
  epicgames:
    type: http
    behavior: domain
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/epicgames.yaml
    path: ./ruleset/epicgames.yaml
    interval: 86400
  ea:
    type: http
    behavior: domain
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/ea.yaml
    path: ./ruleset/ea.yaml
    interval: 86400
  ubisoft:
    type: http
    behavior: domain
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/ubisoft.yaml
    path: ./ruleset/ubisoft.yaml
    interval: 86400
  blizzard:
    type: http
    behavior: domain
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/blizzard.yaml
    path: ./ruleset/blizzard.yaml
    interval: 86400